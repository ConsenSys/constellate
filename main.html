<html>
  <head>
    <title>constellate</title>
  </head>
  <body>
    <select>
      <option selected disabled>type</option>
      <option value='user'>user</option>
      <option value='composition'>composition</option>
      <option value='recording'>recording</option>
    </select>
    <form></form>
    <pre></pre>
  </body>
  <script src='./bundle.js'></script>
  <script type='text/javascript'>
    let pre = document.getElementsByTagName('pre')[0];
    let form = document.getElementsByTagName('form')[0];
    let select = document.getElementsByTagName('select')[0];
    let submit = document.createElement('input');
    submit.type = 'submit';
    select.addEventListener('change', () => {
      form.innerHTML = null;
      switch(select.value) {
        case 'user':
          schema = user;
          break;
        case 'composition':
          schema = composition;
          break;
        case 'recording':
          schema = recording;
          break;
        default:
          console.error(`unexpected type: ${select.value}`);
          return;
      }
      generateForm(schema).forEach((div) => {
        form.appendChild(div);
      });
      form.appendChild(submit);
    });
    form.addEventListener('submit', (event) => {
      event.preventDefault();
      pre.innerHTML = null;
      pre.textContent = JSON.stringify(evalForm(Array.from(form.children).slice(0, -1)), null, 2);
    })
  </script>
</html>
